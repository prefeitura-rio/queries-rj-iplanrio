version: 2

models:
  - name: raw_divida_ativa_certidao_divida_ativa
    description: "Tabela que contém os registros das Certidões de Dívida Ativa (CDA)."
    columns:
      - name: id_certidao_divida_ativa
        description: "Identificador da certidão de dívida ativa (CDA)."
        data_type: int64
        data_tests:
          - not_null:
              name: raw_divida_ativa_certidao_divida_ativa__id_certidao_divida_ativa__not_null
              severity: error
          - unique:
              name: raw_divida_ativa_certidao_divida_ativa__id_certidao_divida_ativa__unique
              severity: error
      - name: ano_de_inscricao_na_divida
        description: "Ano de inscrição na dívida ativa."
        data_type: int64
      - name: sequencial_cda
        description: "Número sequencial da CDA."
        data_type: int64
      - name: numero_nota_debito
        description: "Número da nota de débito."
        data_type: numeric
      - name: imovel_associado_iptu
        description: "Estrutura com os dados do imóvel associado à CDA, caso a dívida ativa seja de IPTU."
        data_type: struct
        columns:
          - name: inscricao_imobiliaria
            description: "Número de inscrição imobiliária do imóvel."
            data_type: int64
          - name: endereco_imovel
            description: "Estrutura com os dados de endereço do imóvel."
            data_type: struct
            columns:
              - name: codigo_logradouro
                description: "Código do logradouro do imóvel."
                data_type: int64
              - name: nome_logradouro
                description: "Nome do logradouro do imóvel."
                data_type: string
              - name: numero_porta
                description: "Número da porta do imóvel."
                data_type: string
              - name: complemento_endereco
                description: "Complemento do endereço do imóvel."
                data_type: string
              - name: bairro
                description: "Bairro do imóvel."
                data_type: string
              - name: cep
                description: "CEP do imóvel."
                data_type: string
          - name: tipologia_imovel
            description: "Estrutura com os dados de tipologia do imóvel."
            data_type: struct
            columns:
              - name: id_tipologia_imovel
                description: "Identificador da tipologia do imóvel."
                data_type: int64
              - name: nome_tipologia_imovel
                description: "Nome da tipologia do imóvel."
                data_type: string
          - name: utilizacao_imovel
            description: "Estrutura com os dados de utilização do imóvel."
            data_type: struct
            columns:
              - name: id_utilizacao_imovel
                description: "Identificador da utilização do imóvel."
                data_type: int64
              - name: nome_utilizacao_imovel
                description: "Nome da utilização do imóvel."
                data_type: string
      - name: situacao_cda
        description: "Estrutura com os dados da situação da CDA."
        data_type: struct
        columns:
          - name: id_situacao_cda
            description: "Identificador da situação da CDA."
            data_type: int64
          - name: descricao_situacao_cda
            description: "Descrição da situação da CDA."
            data_type: string
      - name: natureza_divida_ativa
        description: "Estrutura com os dados da natureza da dívida ativa." 
        data_type: struct
        columns:
          - name: id_natureza_divida
            description: "Identificador da natureza da dívida ativa."
            data_type: int64
          - name: nome_natureza_divida
            description: "Nome da natureza da dívida ativa."
            data_type: string
      - name: data_geracao_cda
        description: "Data de geração da CDA."
        data_type: date
      - name: data_ultima_alteracao_situacao
        description: "Data da última alteração da situação da CDA."
        data_type: date
      - name: numero_processo_associado
        description: "Número do processo administrativo associado à CDA."
        data_type: string
      - name: fase_cobranca
        description: "Estrutura com os dados da fase de cobrança."
        data_type: struct
        columns:
          - name: codigo_fase_cobranca
            description: "Código da fase de cobrança."
            data_type: int64
          - name: nome_fase_cobranca
            description: "Nome da fase de cobrança."
            data_type: string
      - name: valor_saldo_devido
        description: "Valor do saldo devido."
        data_type: numeric
      - name: valor_multa_moratoria
        description: "Valor da multa moratória."
        data_type: numeric
      - name: valor_juros_moratorios
        description: "Valor dos juros moratórios."
        data_type: numeric
      - name: valor_mora
        description: "Valor da mora."
        data_type: numeric
      - name: valor_juros_mora
        description: "Valor dos juros de mora."
        data_type: numeric
      - name: valor_pago_principal
        description: "Valor pago do principal."
        data_type: numeric
      - name: valor_honorarios
        description: "Valor dos honorários."
        data_type: numeric
      - name: valor_mora_smf_iptu
        description: "Valor da mora de origem na SMF caso a CDA seja IPTU."
        data_type: numeric
      - name: valor_original_divida_ativa
        description: "Valor original da dívida ativa."
        data_type: numeric
      - name: codigo_receita_cda
        description: "Código da receita da CDA."
        data_type: string
      - name: entidade_credora
        description: "Estrutura com os dados da entidade credora."
        data_type: struct
        columns:
          - name: id_entidade_credora
            description: "Identificador da entidade credora."
            data_type: int64
          - name: nome_entidade_credora
            description: "Nome da entidade credora."
            data_type: string
        name: guias_associadas
        description: "Lista com os dados das guias de pagamento associadas à CDA."
        data_type: record[]
        columns:
          - name: id_guia_pagamento
            description: "Identificador da guia de pagamento associada."
            data_type: int64
          - name: situacao_associacao
            description: "Situação da associação entre a CDA e a guia de pagamento (ativa ou inativa)."
            data_type: boolean
          - name: descricao_situacao_associacao
            description: "Descrição da situação da associação (Associação ativa ou Associação inativa)."
            data_type: string
          - name: data_retirada_associacao
            description: "Data de retirada da associação entre a CDA e a guia de pagamento."
            data_type: date
          - name: valor_desconto_cda
            description: "Valor do desconto aplicado à CDA."
            data_type: numeric
          - name: ano_referencia_ipcae
            description: "Ano de referência do IPCA-E utilizado."
            data_type: int64
          - name: valor_cda_na_guia
            description: "Valor da certidão de dívida ativa associada."
            data_type: numeric
          - name: percentual_desconto
            description: "Percentual de desconto aplicado."
            data_type: numeric
          - name: valor_desconto_sobre_principal
            description: "Valor do desconto aplicado sobre o principal."
            data_type: numeric
      - name: loaded_at
        description: "Timestamp de quando o dado foi extraído do banco de dados de origem."
        data_type: timestamp
      - name: transformed_at
        description: "Timestamp de quando o dado foi transformado no dbt."
        data_type: timestamp