version: 2

models:
  - name: mart_divida_ativa_guia_pagamento
    description: "MART: guias de pagamento agregadas com CDAs e cotas válidas (filtrando cotas substituídas conforme regras de negócio)."
    columns:
      - name: id_guia_pagamento
        description: "Identificador da guia de pagamento."
        data_type: int64
        data_tests:
          - not_null:
              name: mart_divida_ativa_guia_pagamento__id_guia_pagamento__not_null
              severity: error
          - unique:
              name: mart_divida_ativa_guia_pagamento__id_guia_pagamento__unique
              severity: error

      - name: data_criacao_guia
        description: "Data de criação da guia."
        data_type: datetime

      - name: numero_processo_associado
        description: "Número do processo administrativo associado à guia."
        data_type: string

      # Estrutura que descreve o tipo da Guia de Pagamento
      - name: tipo_guia
        description: "Estrutura com o tipo da guia."
        data_type: struct
      - name: tipo_guia.id_tipo_guia
        description: "Identificador do tipo de guia."
        data_type: int64
      - name: tipo_guia.nome_tipo_guia
        description: "Nome do tipo de guia."
        data_type: string
      #--------

      # Estrutura que descreve o tipo de pagamento da Guia
      - name: tipo_pagamento
        description: "Estrutura com o tipo de pagamento da guia."
        data_type: struct
      - name: tipo_pagamento.id_tipo_pagamento
        description: "Identificador do tipo de pagamento."
        data_type: int64
      - name: tipo_pagamento.nome_tipo_pagamento
        description: "Nome do tipo de pagamento."
        data_type: string
      #--------

      # Estrutura que descreve o tipo de receita da pagamento da Guia de Pagamento
      - name: tipo_receita
        description: "Estrutura com código e nome da receita da guia."
        data_type: struct
      - name: tipo_receita.codigo_receita
        description: "Código da receita."
        data_type: string
      - name: tipo_receita.nome_receita
        description: "Nome da receita."
        data_type: string
      #--------

      # Estrutura que descreve a situação da Guia de Pagamento
      - name: situacao
        description: "Estrutura com a situação da guia."
        data_type: struct
      - name: situacao.id_situacao_guia_pagamento
        description: "Identificador da situação da guia."
        data_type: int64
      - name: situacao.nome_situacao_guia_pagamento
        description: "Nome da situação da guia."
        data_type: string
      #--------

      - name: quantidade_cdas
        description: "Quantidade de CDAs associadas à guia (vínculos ativos)."
        data_type: int64

      # Estrutura de lista de registros de certidões de dívida ativa (CDA) associadas à guia de pagamento
      - name: cdas_associadas
        description: "Array com as CDAs associadas à guia e seus detalhes."
        data_type: struct
      - name: cdas_associadas.id_certidao_divida_ativa
        description: "Identificador da CDA."
        data_type: int64
      - name: cdas_associadas.ano_de_inscricao_na_divida
        description: "Ano de inscrição na dívida ativa."
        data_type: int64
      - name: cdas_associadas.data_geracao_cda
        description: "Data de geração da CDA."
        data_type: date
      #--------

      - name: cdas_associadas.data_ultima_alteracao_situacao
        description: "Data da última alteração da situação da CDA."
        data_type: date

      - name: cdas_associadas.numero_processo_associado
        description: "Processo administrativo associado à CDA."
        data_type: string

      - name: cdas_associadas.valor_original_divida_ativa
        description: "Valor original da dívida ativa da CDA."
        data_type: numeric

      - name: cdas_associadas.valor_saldo_devido
        description: "Saldo devido da CDA."
        data_type: numeric

      - name: cdas_associadas.valor_multa_moratoria
        description: "Multa moratória da CDA."
        data_type: numeric

      - name: cdas_associadas.valor_juros_moratorios
        description: "Juros moratórios da CDA."
        data_type: numeric

      - name: cdas_associadas.valor_mora
        description: "Valor da mora."
        data_type: numeric

      - name: cdas_associadas.valor_juros_mora
        description: "Juros de mora."
        data_type: numeric

      - name: cdas_associadas.valor_pago_principal
        description: "Valor pago referente ao principal."
        data_type: numeric

      - name: cdas_associadas.valor_honorarios
        description: "Valor de honorários da CDA."
        data_type: numeric

      - name: cdas_associadas.valor_mora_smf_iptu
        description: "Valor da mora SMF IPTU."
        data_type: numeric

      # Estrutura que descreve o tipo de receita da certidão de dívida ativa (CDA) associada à guia de pagamento
      - name: cdas_associadas.tipo_receita
        description: "Estrutura com código e nome da receita da CDA."
        data_type: struct
      - name: cdas_associadas.tipo_receita.codigo_receita
        description: "Código da receita."
        data_type: string
      - name: cdas_associadas.tipo_receita.nome_receita
        description: "Nome da receita."
        data_type: string
      #--------

      # Estrutura que descreve entidade credora da certidão de dívida ativa (CDA) associada à guia de pagamento
      - name: cdas_associadas.entidade_credora
        description: "Estrutura com os dados da entidade credora."
        data_type: struct
      - name: cdas_associadas.entidade_credora.id_entidade_credora
        description: "Identificador da entidade credora."
        data_type: int64
      - name: cdas_associadas.entidade_credora.nome_entidade_credora
        description: "Nome da entidade credora."
        data_type: string
      #--------

      # Estrutura que descreve fase de cobrança da certidão de dívida ativa (CDA) associada à guia de pagamento
      - name: cdas_associadas.fase_cobranca
        description: "Estrutura com a fase de cobrança da CDA."
        data_type: struct
      - name: cdas_associadas.fase_cobranca.codigo_fase_cobranca
        description: "Código da fase de cobrança."
        data_type: int64
      - name: cdas_associadas.fase_cobranca.nome_fase_cobranca
        description: "Nome da fase de cobrança."
        data_type: string
      #--------

      # Estrutura que descreve a situação da certidão de dívida ativa (CDA) associada à guia de pagamento
      - name: cdas_associadas.situacao_cda
        description: "Estrutura com a situação da CDA."
        data_type: struct
      - name: cdas_associadas.situacao_cda.id_situacao_cda
        description: "ID da situação da CDA."
        data_type: int64
      - name: cdas_associadas.situacao_cda.descricao_situacao_cda
        description: "Descrição da situação da CDA."
        data_type: string
      #--------

      # Estrutura que descreve a natureza da dívida da certidão de dívida ativa (CDA) associada à guia de pagamento
      - name: cdas_associadas.natureza_divida_ativa
        description: "Estrutura com a natureza da dívida ativa."
        data_type: struct
      - name: cdas_associadas.natureza_divida_ativa.id_natureza_divida
        description: "ID da natureza da dívida."
        data_type: int64
      - name: cdas_associadas.natureza_divida_ativa.nome_natureza_divida
        description: "Nome da natureza da dívida."
        data_type: string
      #--------

      - name: cdas_associadas.dados_complementares
        description: "Dados complementares da CDA."
        data_type: string

      - name: cdas_associadas.quantidade_devedores_cda
        description: "Quantidade de devedores vinculados à CDA."
        data_type: int64

      # Estrutura de lista de devedores principais da certidão de dívida ativa (CDA) associada à guia de pagamento
      - name: cdas_associadas.devedores_vinculados_cda
        description: "Array com os devedores vinculados à CDA."
        data_type: struct
      
      # informações sobre imóvel associado à CDA
      - name: cdas_associadas.possui_imovel_associado
        description: "Indica se a CDA possui imóvel associado."
        data_type: boolean
      - name: cdas_associadas.imovel_associado
        description: "Estrutura com dados do imóvel associado."
        data_type: struct

      # Informações sobre as cotas (parcelas) da guia de pagamento
      - name: quantidade_cotas
        description: "Quantidade de cotas (parcelas) válidas associadas à guia (após regras de substituição)."
        data_type: int64

      # Estrutura de lista das cotas da guia de pagamento
      - name: cotas
        description: "Array com as cotas válidas (parcela) da guia e seus detalhes."
        data_type: struct
      - name: cotas.id_guia_pagamento
        description: "Identificador da guia da cota."
        data_type: int64
      - name: cotas.id_cota_guia_pagamento
        description: "Identificador da cota (parcela)."
        data_type: int64
      - name: cotas.cota_paga
        description: "Indica se a cota foi paga."
        data_type: boolean
      - name: cotas.cota_substituida
        description: "Indica se a cota foi substituída."
        data_type: boolean
      - name: cotas.substituta_de_outra
        description: "Indica se esta cota é substituta de outra."
        data_type: boolean
      - name: cotas.valor_cota_guia_pagamento
        description: "Valor total da cota."
        data_type: numeric
      - name: cotas.data_emissao
        description: "Data de emissão da cota."
        data_type: date
      - name: cotas.data_vencimento
        description: "Data de vencimento da cota."
        data_type: date
      - name: cotas.data_pagamento
        description: "Data de pagamento da cota (se houver)."
        data_type: date
      - name: cotas.valor_principal
        description: "Valor principal da cota."
        data_type: numeric
      - name: cotas.valor_honorarios
        description: "Valor de honorários da cota."
        data_type: numeric
      - name: cotas.valor_juros
        description: "Valor de juros da cota."
        data_type: numeric
      - name: cotas.valor_grerj
        description: "Valor GRERJ da cota."
        data_type: numeric
      - name: cotas.valor_juros_principal
        description: "Juros sobre o principal."
        data_type: numeric
      - name: cotas.valor_juros_honorarios
        description: "Juros sobre honorários."
        data_type: numeric
      - name: cotas.observacoes
        description: "Observações da cota."
        data_type: string
      - name: cotas.valor_principal_pago
        description: "Valor principal pago da cota."
        data_type: numeric
      - name: cotas.valor_juros_pago
        description: "Valor de juros pago da cota."
        data_type: numeric
      - name: cotas.valor_honorarios_pago
        description: "Valor de honorários pago da cota."
        data_type: numeric
      - name: cotas.valor_grerj_pago
        description: "Valor GRERJ pago da cota."
        data_type: numeric
      - name: cotas.valor_juros_honorarios_pago
        description: "Valor de juros sobre honorários pago."
        data_type: numeric
      - name: cotas.ano_ipcae
        description: "Ano de referência do IPCA-E utilizado na cota."
        data_type: int64